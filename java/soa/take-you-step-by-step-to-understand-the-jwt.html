<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.38" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="http://www.zhangsj.xyz/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html"><meta property="og:site_name" content="ShijingSpace"><meta property="og:title" content="前后端分离利器之JWT"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-04-16T23:42:59.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="徐刘根"><meta property="article:tag" content="jwt"><meta property="article:published_time" content="2018-02-01T00:00:00.000Z"><meta property="article:modified_time" content="2022-04-16T23:42:59.000Z"><link rel="stylesheet" href="//at.alicdn.com/t/font_3166858_nfzh5q0te6g.css"><title>前后端分离利器之JWT | ShijingSpace</title><meta name="description" content="Java学习&&面试指南">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/blog/assets/style.49bb0069.css">
    <link rel="modulepreload" href="/blog/assets/app.9da19d67.js"><link rel="modulepreload" href="/blog/assets/take-you-step-by-step-to-understand-the-jwt.html.cb9b09b2.js"><link rel="modulepreload" href="/blog/assets/take-you-step-by-step-to-understand-the-jwt.html.e38fdf37.js"><link rel="modulepreload" href="/blog/assets/plugin-vue_export-helper.21dcd24c.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc sidebar-open"><!--[--><header class="navbar"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><a href="/blog/" class="home-link"><img class="logo" src="/blog/logo.svg" alt="ShijingSpace"><!----><span class="site-name hide-in-pad">ShijingSpace</span><!--[--><!----><!--]--></a><nav class="nav-links" style=""><div class="nav-item hide-in-mobile"><a href="/blog/" class="nav-link" arialabel="主页"><i class="icon iconfont icon-bloghome"></i>主页<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="java"><span class="title"><i class="icon iconfont icon-blogguide"></i>java</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/blog/java/basic" class="nav-link" arialabel="基础"><!---->基础<!----></a></li><li class="dropdown-item"><a href="/blog/java/concurrent" class="nav-link" arialabel="并发"><!---->并发<!----></a></li><li class="dropdown-item"><a href="/blog/java/datasource" class="nav-link" arialabel="数据库"><!---->数据库<!----></a></li><li class="dropdown-item"><a href="/blog/java/design-patterns" class="nav-link" arialabel="设计模式"><!---->设计模式<!----></a></li><li class="dropdown-item"><a href="/blog/java/interview.html" class="nav-link" arialabel="面经"><!---->面经<!----></a></li><li class="dropdown-item"><a href="/blog/java/jvm" class="nav-link" arialabel="JVM"><!---->JVM<!----></a></li><li class="dropdown-item"><a href="/blog/java/message-queue" class="nav-link" arialabel="消息队列"><!---->消息队列<!----></a></li><li class="dropdown-item"><a href="/blog/java/redis" class="nav-link" arialabel="缓存"><!---->缓存<!----></a></li><li class="dropdown-item"><a href="/blog/java/soa" class="nav-link active" arialabel="分布式"><!---->分布式<!----></a></li><li class="dropdown-item"><a href="/blog/java/spring" class="nav-link" arialabel="spring"><!---->spring<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="其他"><span class="title"><i class="icon iconfont icon-blogguide"></i>其他</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/blog/note" class="nav-link" arialabel="随笔"><!---->随笔<!----></a></li><li class="dropdown-item"><a href="/blog/vue" class="nav-link" arialabel="前端"><!---->前端<!----></a></li><li class="dropdown-item"><a href="/blog/tool" class="nav-link" arialabel="工具"><!---->工具<!----></a></li><li class="dropdown-item"><a href="/blog/algo" class="nav-link" arialabel="算法"><!---->算法<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="工具"><span class="title"><i class="icon iconfont icon-blogtool"></i>工具</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/blog/tool/idea-plugin.html" class="nav-link" arialabel="idea"><!---->idea<!----></a></li><li class="dropdown-item"><a href="/blog/tool/vscode-plugins-and-configuration.html" class="nav-link" arialabel="vscode"><!---->vscode<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="https://blog.csdn.net/qq_43183527" rel="noopener noreferrer" target="_blank" arialabel="博客" class="nav-link"><i class="icon iconfont icon-blogblog"></i>博客<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="nav-item hide-in-mobile"><a href="/blog/about" class="nav-link" arialabel="关于作者"><i class="icon iconfont icon-blogguide"></i>关于作者<!----></a></div></nav><div class="nav-actions-wrapper"><!--[--><!----><!--]--><div class="nav-item"><!----></div><div class="nav-item"><a class="repo-link" href="https://github.com/coderzsj/blog" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" arialabelledby="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><title id="github" lang="en">github icon</title><g fill="currentColor"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></g></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" arialabelledby="auto" style="display:block;"><title id="auto" lang="en">auto icon</title><g fill="currentColor"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></g></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" arialabelledby="dark" style="display:none;"><title id="dark" lang="en">dark icon</title><g fill="currentColor"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></g></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" arialabelledby="light" style="display:none;"><title id="light" lang="en">light icon</title><g fill="currentColor"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></g></svg></button></div><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button><!--[--><!----><!--]--></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/blog/java/" class="nav-link sidebar-link sidebar-page" arialabel="java"><i class="icon iconfont icon-blogmulu"></i>java<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading"><i class="icon iconfont icon-blogbasic"></i><span class="title">基础</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/blog/java/basic/java-exception.html" class="nav-link sidebar-link sidebar-page" arialabel="java异常"><i class="icon iconfont icon-blogexception"></i>java异常<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/basic/hashmap.html" class="nav-link sidebar-link sidebar-page" arialabel="hashMap知识点汇总"><i class="icon iconfont icon-bloghashmap"></i>hashMap知识点汇总<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/basic/still-using-SimpleDateFormat.html" class="nav-link sidebar-link sidebar-page" arialabel="仍在使用SimpleDateFormat？"><!---->仍在使用SimpleDateFormat？<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title">设计模式</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/blog/java/design-patterns/let-me-tell-you-what-design-patterns-are-used-in-spring.html" class="nav-link sidebar-link sidebar-page" arialabel="spring中涉及到九种设计模式"><!---->spring中涉及到九种设计模式<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/design-patterns/singleton-design.html" class="nav-link sidebar-link sidebar-page" arialabel="Java设计模式--单例模式！"><!---->Java设计模式--单例模式！<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/design-patterns/six-principles-of-design-patterns.html" class="nav-link sidebar-link sidebar-page" arialabel="设计模式遵循的一些原则"><!---->设计模式遵循的一些原则<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading"><i class="icon iconfont icon-blogredis"></i><span class="title">缓存</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/blog/java/redis/redis.html" class="nav-link sidebar-link sidebar-page" arialabel="Redis调优"><!---->Redis调优<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/redis/interview.html" class="nav-link sidebar-link sidebar-page" arialabel="Redis知识点汇总"><i class="icon iconfont icon-bloginterview"></i>Redis知识点汇总<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading"><i class="icon iconfont icon-blogbingfazheng"></i><span class="title">并发编程</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/blog/java/concurrent/synchronized-principle-analysis-and-optimization.html" class="nav-link sidebar-link sidebar-page" arialabel="synchronized"><!---->synchronized<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/concurrent/thread-life-cycle.html" class="nav-link sidebar-link sidebar-page" arialabel="线程生命周期"><!---->线程生命周期<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/concurrent/4-reference-types.html" class="nav-link sidebar-link sidebar-page" arialabel="四种引用类型"><!---->四种引用类型<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/concurrent/aqs-source-code-reading-notes.html" class="nav-link sidebar-link sidebar-page" arialabel="AQS"><!---->AQS<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/concurrent/threadpool-code-analysis.html" class="nav-link sidebar-link sidebar-page" arialabel="线程池分析"><!---->线程池分析<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/concurrent/threadlocal.html" class="nav-link sidebar-link sidebar-page" arialabel="ThreadLocal的介绍与使用"><!---->ThreadLocal的介绍与使用<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading"><i class="icon iconfont icon-blogbxl-spring-boot"></i><span class="title">spring</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/blog/java/spring/spring.html" class="nav-link sidebar-link sidebar-page" arialabel="Spring MVC 运行及启动流程"><i class="icon iconfont icon-blogbxl-spring-boot"></i>Spring MVC 运行及启动流程<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/spring/springboot-startup-process.html" class="nav-link sidebar-link sidebar-page" arialabel="springboot自动装配原理"><i class="icon iconfont icon-blogzidong-02"></i>springboot自动装配原理<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/spring/spring-transaction.html" class="nav-link sidebar-link sidebar-page" arialabel="spring事务"><i class="icon iconfont icon-blogguanli"></i>spring事务<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/spring/@RequestBody&amp;ResponseBody.html" class="nav-link sidebar-link sidebar-page" arialabel="请求正文&amp;响应正文"><i class="icon iconfont icon-blogannotation"></i>请求正文&amp;响应正文<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading"><i class="icon iconfont icon-blogmqxiaoxiduilieMQ"></i><span class="title">消息队列</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/blog/java/message-queue/kafka.html" class="nav-link sidebar-link sidebar-page" arialabel="kafka概念，使用，架构"><!---->kafka概念，使用，架构<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/message-queue/rabbit.html" class="nav-link sidebar-link sidebar-page" arialabel="RabbitMQ知识点总结"><!---->RabbitMQ知识点总结<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading"><i class="icon iconfont icon-blogdatasource"></i><span class="title">数据库</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/blog/java/datasource/detailed-explanation-of-b-tree-and-b+-tree.html" class="nav-link sidebar-link sidebar-page" arialabel="b-tree和b+tree的详细解释"><i class="icon iconfont icon-blogtree"></i>b-tree和b+tree的详细解释<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/datasource/mysql-tuning.html" class="nav-link sidebar-link sidebar-page" arialabel="sql优化"><i class="icon iconfont icon-blogyouhuayunhang"></i>sql优化<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/datasource/mysql-transaction.html" class="nav-link sidebar-link sidebar-page" arialabel="MySQL事务"><i class="icon iconfont icon-blogshiwu"></i>MySQL事务<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/datasource/storage-engine.html" class="nav-link sidebar-link sidebar-page" arialabel="dataource"><!---->dataource<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/datasource/explain-execution-plan.html" class="nav-link sidebar-link sidebar-page" arialabel="explain执行计划"><!---->explain执行计划<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading active"><i class="icon iconfont icon-blogfenbushi"></i><span class="title">分布式</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/blog/java/soa/dubbo.html" class="nav-link sidebar-link sidebar-page" arialabel="dubbo知识点总结"><i class="icon iconfont icon-blogdubbo"></i>dubbo知识点总结<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/soa/distributed-transaction.html" class="nav-link sidebar-link sidebar-page" arialabel="分布式事务"><i class="icon iconfont icon-blogfubuhi"></i>分布式事务<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/soa/distributed-id.html" class="nav-link sidebar-link sidebar-page" arialabel="分布式 id"><i class="icon iconfont icon-blogid"></i>分布式 id<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/soa/Zookeeper.html" class="nav-link sidebar-link sidebar-page" arialabel="ZooKeeper"><i class="icon iconfont icon-blogZooKeeper"></i>ZooKeeper<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/soa/spring-cloud.html" class="nav-link sidebar-link sidebar-page" arialabel="spring cloud笔记"><i class="icon iconfont icon-blogcloud"></i>spring cloud笔记<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" arialabel="前后端分离利器之JWT"><!---->前后端分离利器之JWT<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#一、http的无状态性" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="一、HTTP的无状态性"><!---->一、HTTP的无状态性<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#二、cookie-技术的引入" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="二、Cookie 技术的引入"><!---->二、Cookie 技术的引入<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#三、基于表单的认证" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="三、基于表单的认证"><!---->三、基于表单的认证<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#四、session存储位置以及集群情况下的问题" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="四、Session存储位置以及集群情况下的问题"><!---->四、Session存储位置以及集群情况下的问题<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#五、小结与需求痛点" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="五、小结与需求痛点"><!---->五、小结与需求痛点<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#六、jwt是什么" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="六、JWT是什么"><!---->六、JWT是什么<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#七、jwt的结构说明" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="七、JWT的结构说明"><!---->七、JWT的结构说明<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#八、jwt的工作原理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="八、JWT的工作原理"><!---->八、JWT的工作原理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#九、总结" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="九、总结"><!---->九、总结<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading"><i class="icon iconfont icon-blogxuniji"></i><span class="title">虚拟机</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/blog/java/jvm/jvm-tuning.html" class="nav-link sidebar-link sidebar-page" arialabel="jvm调优"><i class="icon iconfont icon-blogyouhuayunhang"></i>jvm调优<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/jvm/jvm-memory-structure.html" class="nav-link sidebar-link sidebar-page" arialabel="JVM内存结构"><!---->JVM内存结构<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/jvm/jvm-garbage-collection.html" class="nav-link sidebar-link sidebar-page" arialabel="jvm-gc"><!---->jvm-gc<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/java/jvm/jvm-class-loading&amp;bytecode-technology.html" class="nav-link sidebar-link sidebar-page" arialabel="JVM类加载与字节码技术&amp;内存模型"><!---->JVM类加载与字节码技术&amp;内存模型<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->前后端分离利器之JWT</h1><div class="article-info"><span class="author-info" arialabel="作者🖊" isoriginal="false" pageview="false" color="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" arialabelledby="author"><title id="author" lang="en">author icon</title><g fill="currentColor"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></g></svg><span><span class="author-item">徐刘根</span></span><span property="author" content="徐刘根"></span></span><!----><span class="date-info" arialabel="写作日期📅" isoriginal="false" pageview="false" color="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" arialabelledby="calendar"><title id="calendar" lang="en">calendar icon</title><g fill="currentColor"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></g></svg><span>2018年2月1日</span><meta property="datePublished" content="2018-02-01T00:00:00.000Z"></span><!----><span arialabel="标签🏷" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewbox="0 0 1024 1024" arialabelledby="tag"><title id="tag" lang="en">tag icon</title><g fill="currentColor"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></g></svg><ul class="tags-wrapper"><li class="tag clickable" role="navigation">jwt</li></ul><meta property="keywords" content="jwt"></span><span class="reading-time-info" arialabel="阅读时间⌛" isoriginal="false" pageview="false" color="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" arialabelledby="timer"><title id="timer" lang="en">timer icon</title><g fill="currentColor"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></g></svg><span>大约 11 分钟</span><meta property="timeRequired" content="PT11M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc-list"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#一、http的无状态性" class="router-link-active router-link-exact-active toc-link level2">一、HTTP的无状态性</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#二、cookie-技术的引入" class="router-link-active router-link-exact-active toc-link level2">二、Cookie 技术的引入</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#三、基于表单的认证" class="router-link-active router-link-exact-active toc-link level2">三、基于表单的认证</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#四、session存储位置以及集群情况下的问题" class="router-link-active router-link-exact-active toc-link level2">四、Session存储位置以及集群情况下的问题</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#五、小结与需求痛点" class="router-link-active router-link-exact-active toc-link level2">五、小结与需求痛点</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#六、jwt是什么" class="router-link-active router-link-exact-active toc-link level2">六、JWT是什么</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#七、jwt的结构说明" class="router-link-active router-link-exact-active toc-link level2">七、JWT的结构说明</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#八、jwt的工作原理" class="router-link-active router-link-exact-active toc-link level2">八、JWT的工作原理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/java/soa/take-you-step-by-step-to-understand-the-jwt.html#九、总结" class="router-link-active router-link-exact-active toc-link level2">九、总结</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><!--[--><h1 id="一步步带你了解前后端分离利器之jwt" tabindex="-1"><a class="header-anchor" href="#一步步带你了解前后端分离利器之jwt" aria-hidden="true">#</a> 一步步带你了解前后端分离利器之JWT</h1><h2 id="一、http的无状态性" tabindex="-1"><a class="header-anchor" href="#一、http的无状态性" aria-hidden="true">#</a> 一、HTTP的无状态性</h2><p>HTTP 是无状态协议，它不对之前发送过的请求和响应的状态进行管理。也就是说，无法根据之前的状态进行本次的请求处理。假设要求登录认证的 Web 页面本身无法进行状态的管理（不记录已登录的状态），那么每次跳转新页面不是要再次登录，就是要在每次请求报文中附加参数来管理登录状态。</p><p>不可否认，无状态协议当然也有它的优点。由于不必保存状态，自然可减少服务器的CPU及内存资源的消耗。从另一侧面来说，也正是因为 <code>HTTP</code> 协议本身是非常简单的，所以才会被应用在各种场景里。</p><h2 id="二、cookie-技术的引入" tabindex="-1"><a class="header-anchor" href="#二、cookie-技术的引入" aria-hidden="true">#</a> 二、Cookie 技术的引入</h2><p>如果让服务器管理全部客户端状态则会成为负担，保留无状态协议这个特征的同时又要解决类似的矛盾问题，于是引入了 Cookie 技术。Cookie 技术通过在请求和响应报文中写入Cookie信息来控制客户端的状态。</p><p>Cookie 会根据从服务器端发送的响应报文内的一个叫做<code>Set-Cookie</code> 的首部字段信息，通知客户端保存 Cookie。当下次客户端再往该服务器发送请求时，客户端会自动在请求报文中加入 Cookie 值后发送出去。</p><p>1、没有 Cookie 信息状态下的请求（来源《图解HTTP》）</p><p>客户端 保存 Cookie</p><p>请求 -&gt; ①保存请求</p><p>响应 &lt;- ②在响应中添加Cookie后返回</p><p>服务器 生成Cookie记住是向谁发送到</p><p>2、第 2 次以后（存有 Cookie 信息状态） 的请求（来源《图解HTTP》）</p><p>Client</p><p>request -&gt; ③请求中添加Cookie后send</p><p>response &lt;-</p><p>server ④检查Cookie （是刚才生成的Cookie）</p><p>3、详细介绍Cookie 传输过程</p><p>server发现client发送过来的Cookie后，回去check 是从哪一个client发来的request，然后对比server上的记录，最后得到之前的状态信息。</p><h2 id="三、基于表单的认证" tabindex="-1"><a class="header-anchor" href="#三、基于表单的认证" aria-hidden="true">#</a> 三、基于表单的认证</h2><p>目前用户的认证多半是基于表单的认证，基于表单的认证一般会使用 Cookie 来管理Session（Session会话，Session代表着服务器和客户端一次会话的过程，直到Session失效（服务端关闭）或者客户端关闭时结束）。基于表单认证本身是通过服务器端的 Web应用，将客户端发送过来的用户ID和密码与之前登录过的信息做匹配来进行认证的。</p><p>但鉴于 HTTP 是无状态协议，之前已认证成功的用户状态无法通过协议层面保存下来。即无法实现状态管理，因此即使当该用户下一次继续访问，也无法区分它与其他的用户。于是我们会使用Cookie来管理Session，以弥补HTTP协议中不存在状态管理功能。</p><h2 id="四、session存储位置以及集群情况下的问题" tabindex="-1"><a class="header-anchor" href="#四、session存储位置以及集群情况下的问题" aria-hidden="true">#</a> 四、Session存储位置以及集群情况下的问题</h2><p>Session 是存储在Web服务器（例如：Tomcat）中的，并针对每个客户端（客户），通过SessionID来区别不同用户的。Session是以Cookie技术或URL重写实现，默认以Cookie技术实现，服务端会给这次会话创造一个JSESSIONID的Cookie值。</p><p>但是一个显著的问题就是，在集群模式下如果通过Nginx负载均衡的时候，如果有一个用户登录的时候请求被分配到服务器A上，登录成功后设置的Session就会存放在服务器A上了，但是在服务器B上却没有该用户的Session数据，当用户再次发起一个请求的时候，此时请求如果被分配到服务器B上，则就不会查询到该用户的登录状态，就会出现登录失败的情况！</p><p>一种可以想到的方式就是将多个Web服务器上存储的Session统一存储到某一存储介质中，保证进集群中的每一台机器都可以看到所有相同Session数据，这里的同步体现在所有的Session存储在同一的存储介质里边。</p><p>幸运的是我们常用的Tomcat容器已经为我们提供了一个接口，可以让我们实现将Session存储到除当前服务器之外的其他存储介质上，例如Redis等。</p><p>了解Spring Session的小伙伴可能都会知道<code>Spring Session</code>的本质就是通过实现Tomcat提供的该接口将Session存储到Redis中，以此来实现Session的统一存储管理，对Spring Session有兴趣的小伙伴可以参考往期的文章：</p><p><a href="https://mp.weixin.qq.com/s?__biz=MzI1NDQ3MjQxNA==&amp;mid=2247483665&amp;idx=1&amp;sn=126be172d9804cdcf75a17b50dcd48fa&amp;chksm=e9c5f8a0deb271b62898af1266da1bde81aed33b231b7c79216dd550d467401728bb6726f5bd&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">使用Redis存储Nginx+Tomcat负载均衡集群的Session<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="五、小结与需求痛点" tabindex="-1"><a class="header-anchor" href="#五、小结与需求痛点" aria-hidden="true">#</a> 五、小结与需求痛点</h2><p>Session和Cookie的目的相同，都是为了克服HTTP协议无状态的缺陷，但完成的方法不同。Session通过Cookie，在客户端保存SessionID，而将用户的其他会话消息保存在服务端的Session对象中，与此相对的，Cookie需要将所有信息都保存在客户端。因此Cookie存在着一定的安全隐患，例如本地Cookie中保存的用户名密码被破译，或Cookie被其他网站收集，例如：</p><ol><li><p>appA主动设置域B cookie，让域B cookie获取；</p></li><li><p>XSS，在appA上通过JavaScript获取document.cookie，并传递给自己的appB。</p></li></ol><p>上述过程我们简单的描述了Session的演进过程还有使用同步的方式解决Session在集群的时候出现的问题，但是我们意识到了使用Spring Session的方式来实现Session的同步是一件相对比较麻烦的事情，我们虽然使用Redis来进行同步，但是Redis并不是100%可靠的，我们需要对Redis搭建集群、进行主从同步复制、进行持久化等，显然这是一件很复杂的事情，因此有没有一种小而轻便的方式来实现我们的这种<strong>认证需求</strong>！那就是JWT了！</p><p>除了上述我们遇到的问题之外，在目前前后端分离的大环境下经常会遇到需要根据用户来分配权限和显示相对应信息的问题，虽然传统的Cookie和Session机制可以解决这个问题，但就通用性而言，JWT（JSON Web Token）相对来说更好。</p><p>看到这里很多小伙伴都已经按捺不住了！那JWT到底是什么呢？</p><h2 id="六、jwt是什么" tabindex="-1"><a class="header-anchor" href="#六、jwt是什么" aria-hidden="true">#</a> 六、JWT是什么</h2><p>Json web token (JWT)，是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准（(RFC 7519)。该标准被设计为紧凑且安全的，一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外的其它业务逻辑所必须的声明信息。当然该标准也可直接被用于认证，也可被加密。</p><p><strong>JWT的几个特点：</strong></p><p>1、由于它们的尺寸较小，JWT可以通过URL，POST参数或HTTP头部发送。 另外，尺寸越小意味着传输速度越快。</p><p>2、有效载荷包含有关用户的所有必需信息，避免了多次查询数据库的需要。</p><p><strong>JWT的使用场景：</strong></p><p>1.验证 这是使用JWT 最常见的情况。 一旦用户登录，每个后续请求将包括JWT。它将允许用户访问该令牌允许的路由，服务和资源。 单点登录是当今广泛使用JWT的一项功能，因为它的开销很小，而且能够轻松地跨不同域使用。 2.信息交换 JWT 是在各方之间安全传输信息的好方法， 因为JWT可以被签名（例如使用公钥/私钥对进行签名）。所以你可以确定发件人是他们说的那个人。 此外，由于使用头部（header）和有效载荷（payload）计算签名，因此您还可以验证内容是否未被篡改。</p><h2 id="七、jwt的结构说明" tabindex="-1"><a class="header-anchor" href="#七、jwt的结构说明" aria-hidden="true">#</a> 七、JWT的结构说明</h2><p>JWT包含三个由点（.）分隔的部分，它们是：</p><ul><li>头部（header）</li><li>有效负载（payload）</li><li>签名（signature）</li></ul><p>因此，JWT通常看起来如下所示:</p><p>xxxxx.yyyyy.zzzzz</p><p>1、头部（header）</p><p>头部（header）通常由两部分组成：令牌的类型（即JWT）和正在使用的散列算法（如HMAC SHA256或RSA）。如下所示：</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;alg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HS256&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;typ&quot;</span><span class="token operator">:</span> <span class="token string">&quot;JWT&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>然后，将这个JSON用Base64编码，形成JWT的第一部分。</p><p>2、有效负载（payload）</p><p>令牌的第二部分是包含声明的有效载荷。 声明是关于实体（通常是用户）和附加元数据的声明。 有三种类型的声明：</p><p>标准中注册的声明；</p><p>公开声明；</p><p>私人声明；</p><p>（1）标准中注册的声明：这是一组预先定义的声明，这些声明不是强制性的，但建议提供一套有用的，可互操作的声明。 如下：</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code>iss: jwt签发者

sub: jwt所面向的用户

aud: 接收jwt的一方

exp: jwt的过期时间，这个过期时间必须要大于签发时间

nbf: 定义在什么时间之前，该jwt都是不可用的.

iat: jwt的签发时间

jti: jwt的唯一身份标识，主要用来作为一次性token,从而回避重放攻击。
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>注意：声明名称只有三个字符长，因为JWT是紧凑的。</p><p>（2）公开声明：这些可以由使用JWT的人员随意定义。 但为避免冲突，应在IANA JSON Web令牌注册表中定义它们，或者将其定义为包含防冲突命名空间的URI。</p><p>（3）私人声明：这是为了共享使用它们的当事方之间共享信息而创建的声明，既不是登记声明，也不是公开声明。</p><p>示例如下：</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
 <span class="token property">&quot;sub&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1234567890&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;john&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;admin&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>然后将有效载荷进行Base64编码，以形成JSON Web令牌的第二部分。</p><p>3、签名（signature）</p><p>要创建签名部分，您必须采用头部（header），有效载荷（payload），密钥（secret），以及头部中指定的算法。例如，如果你想使用HMACSHA256算法，签名将按以下方式创建：</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>HMACSHA256<span class="token punctuation">{</span>
base64UrlEncoded(header)+<span class="token string">&quot;.&quot;</span>+base64UrlEncoded(payload)<span class="token punctuation">,</span>
secret
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>签名通常用于验证JWT的发件人是谁，并JWT在传送的过程中不被篡改。</p><p>注意：上图红框中的secret是保存在服务器端的，JWT的签发生成也是在服务器端的，secret就是用来进行JWT的签发和jwt的验证，所以，它就是你服务端的私钥，在任何场景都不应该流露出去。一旦客户端得知这个secret，那就意味着客户端是可以自我签发jwt了。</p><p>4、案例演示</p><p>显示了一个登录请求成功之后服务端返回的Token，它由编码头部（header）、编码有效载荷（payload）和签名（signature）通过（.）拼接而成：</p><p>如果需要，你可以使用jwt.io的Debugger工具，来编码、验证和生成JWT。操作界面如下：</p><h2 id="八、jwt的工作原理" tabindex="-1"><a class="header-anchor" href="#八、jwt的工作原理" aria-hidden="true">#</a> 八、JWT的工作原理</h2><p>在身份验证中，当用户使用他们的凭证（如用户名、密码）成功登录时，后台服务器将返回一个token，前端接收到这个token将其保存在本地（通常在本地存储中，也可以使用Cookie，但不是传统方法中创建会话，服务器并返回一个cookie）。下次用户想要访问受保护的路由或资源时，就将本地保存的token放在头部Header中发送到后台服务器。服务器接收到请求，检查头部中token的存在，如果存在就允许访问受保护的路由或资源，否则就不允许。如下所示：</p><p>一般默认的Value是以“<code>Bearer</code> ”开始，注意这里的<code>Bearer</code>之后有一个空格，以便后端进行分割。</p><p>这是一种无状态身份验证机制，因为用户状态永远不会保存在服务器内存中。由于JWT是独立的，所有必要的信息都在那里，所以减少了多次查询数据库的需求。</p><h2 id="九、总结" tabindex="-1"><a class="header-anchor" href="#九、总结" aria-hidden="true">#</a> 九、总结</h2><p>1、优点</p><ul><li>（1）因为Json的通用性，所以JWT 是可以进行跨语言支持的，像Java、JavaScript、NodeJS、PHP等很多语言都可以使用。</li><li>（2）因为有了payload部分，所以JWT 可以在自身存储一些其他业务逻辑所必要的非敏感信息。</li><li>（3）便于传输，JWT 的构成非常简单，字节占用很小，所以它是非常便于传输的。</li><li>（4）它不需要在服务端保存会话信息, 所以它易于应用的扩展</li></ul><p>2、安全相关</p><ul><li>（1）不应该在JWT的payload 部分存放敏感信息，因为该部分是客户端可解密的部分。</li><li>（2）保护好secret私钥，该私钥非常重要。</li><li>（3）如果可以，请使用HTTPS 协议，不！是务必使用HTTPS!</li></ul><!--]--></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/coderzsj/blog/edit/dev/docs/java/soa/take-you-step-by-step-to-understand-the-jwt.md" rel="noopener noreferrer" target="_blank" arialabel="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" arialabelledby="edit"><title id="edit" lang="en">edit icon</title><g fill="currentColor"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></g></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">上次编辑于: </span><span class="info">2022/4/17 07:42:59</span></div><div class="meta-item contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: 945892500@qq.com">SHIJINGSPACE</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/blog/java/soa/spring-cloud.html" class="nav-link prev" arialabel="spring cloud笔记"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><i class="icon iconfont icon-blogcloud"></i>spring cloud笔记</div></a><!----></nav><!----><!----></main><!--]--><footer class="footer-wrapper"><div class="footer"><a href="https://beian.miit.gov.cn/" target="_blank">晋ICP备2021007439号</a></div><div class="copyright">Copyright © 2022 徐刘根</div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/blog/assets/app.9da19d67.js" defer></script>
  </body>
</html>
