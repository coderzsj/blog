(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{493:function(s,a,n){s.exports=n.p+"assets/img/3-1.ce975a50.png"},494:function(s,a,n){s.exports=n.p+"assets/img/3-2.734b1b2b.png"},495:function(s,a,n){s.exports=n.p+"assets/img/3-3.4c5d3ede.png"},613:function(s,a,n){"use strict";n.r(a);var t=n(1),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"class-load"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#class-load"}},[s._v("#")]),s._v(" class load")]),s._v(" "),t("p",[s._v("类加载与字节码技术")]),s._v(" "),t("p",[t("img",{attrs:{src:n(493),alt:"",loading:"lazy"}})]),s._v(" "),t("p",[s._v("1、类文件结构")]),s._v(" "),t("p",[s._v("通过 javac 类名.java 编译 java 文件后，会生成一个 .class 的文件！")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("0000000 ca fe ba be 00 00 00 34 00 23 0a 00 06 00 15 09\n0000020 00 16 00 17 08 00 18 0a 00 19 00 1a 07 00 1b 07\n0000040 00 1c 01 00 06 3c 69 6e 69 74 3e 01 00 03 28 29\n0000060 56 01 00 04 43 6f 64 65 01 00 0f 4c 69 6e 65 4e\n0000100 75 6d 62 65 72 54 61 62 6c 65 01 00 12 4c 6f 63\n0000120 61 6c 56 61 72 69 61 62 6c 65 54 61 62 6c 65 01\n0000140 00 04 74 68 69 73 01 00 1d 4c 63 6e 2f 69 74 63\n0000160 61 73 74 2f 6a 76 6d 2f 74 35 2f 48 65 6c 6c 6f\n0000200 57 6f 72 6c 64 3b 01 00 04 6d 61 69 6e 01 00 16\n0000220 28 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72\n0000240 69 6e 67 3b 29 56 01 00 04 61 72 67 73 01 00 13\n0000260 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69\n0000300 6e 67 3b 01 00 10 4d 65 74 68 6f 64 50 61 72 61\n0000320 6d 65 74 65 72 73 01 00 0a 53 6f 75 72 63 65 46\n0000340 69 6c 65 01 00 0f 48 65 6c 6c 6f 57 6f 72 6c 64\n0000360 2e 6a 61 76 61 0c 00 07 00 08 07 00 1d 0c 00 1e\n0000400 00 1f 01 00 0b 68 65 6c 6c 6f 20 77 6f 72 6c 64\n0000420 07 00 20 0c 00 21 00 22 01 00 1b 63 6e 2f 69 74\n0000440 63 61 73 74 2f 6a 76 6d 2f 74 35 2f 48 65 6c 6c\n0000460 6f 57 6f 72 6c 64 01 00 10 6a 61 76 61 2f 6c 61\n0000500 6e 67 2f 4f 62 6a 65 63 74 01 00 10 6a 61 76 61\n0000520 2f 6c 61 6e 67 2f 53 79 73 74 65 6d 01 00 03 6f\n0000540 75 74 01 00 15 4c 6a 61 76 61 2f 69 6f 2f 50 72\n0000560 69 6e 74 53 74 72 65 61 6d 3b 01 00 13 6a 61 76\n0000600 61 2f 69 6f 2f 50 72 69 6e 74 53 74 72 65 61 6d\n0000620 01 00 07 70 72 69 6e 74 6c 6e 01 00 15 28 4c 6a\n0000640 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b\n0000660 29 56 00 21 00 05 00 06 00 00 00 00 00 02 00 01\n0000700 00 07 00 08 00 01 00 09 00 00 00 2f 00 01 00 01\n0000720 00 00 00 05 2a b7 00 01 b1 00 00 00 02 00 0a 00\n0000740 00 00 06 00 01 00 00 00 04 00 0b 00 00 00 0c 00\n0000760 01 00 00 00 05 00 0c 00 0d 00 00 00 09 00 0e 00\n0001000 0f 00 02 00 09 00 00 00 37 00 02 00 01 00 00 00\n0001020 09 b2 00 02 12 03 b6 00 04 b1 00 00 00 02 00 0a\n0001040 00 00 00 0a 00 02 00 00 00 06 00 08 00 07 00 0b\n0001060 00 00 00 0c 00 01 00 00 00 09 00 10 00 11 00 00\n0001100 00 12 00 00 00 05 01 00 10 00 00 00 01 00 13 00\n0001120 00 00 02 00 14\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br")])]),t("p",[s._v("据 JVM 规范，类文件结构如下：")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("u4       magic\nu2             minor_version;\nu2             major_version;\nu2             constant_pool_count;\ncp_info        constant_pool[constant_pool_count-1];\nu2             access_flags;\nu2             this_class;\nu2             super_class;\nu2             interfaces_count;\nu2             interfaces[interfaces_count];\nu2             fields_count;\nfield_info     fields[fields_count];\nu2             methods_count;\nmethod_info    methods[methods_count];\nu2             attributes_count;\nattribute_info attributes[attributes_count];\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("1）魔数")]),s._v(" "),t("p",[s._v("U4 magic\n对应字节码文件的 0~3 个字节\n0000000 ca fe ba be 00 00 00 34 00 23 0a 00 06 00 15 09\nca fe ba be ：意思是 .class 文件，不同的东西有不同的魔数，比如 jpg、PNG 图片等！")]),s._v(" "),t("p",[s._v("2）版本")]),s._v(" "),t("p",[s._v("U2 minor_version;\nu2 major_version;\n0000000 ca fe ba be 00 00 00 34 00 23 0a 00 06 00 15 09\n00 00 00 34：34H(16 进制) = 52(10 进制)，代表 JDK8")]),s._v(" "),t("p",[s._v("3）常量池\n…")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-2.html#jvms-2.5.5",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考文档"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"_2、字节码指令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、字节码指令"}},[s._v("#")]),s._v(" 2、字节码指令")]),s._v(" "),t("p",[s._v("可参考：")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-6.html#jvms-6.5",target:"_blank",rel:"noopener noreferrer"}},[s._v("字节码指令"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"_1-javap-工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-javap-工具"}},[s._v("#")]),s._v(" 1）javap 工具")]),s._v(" "),t("p",[s._v("Java 中提供了 javap 工具来反编译 class 文件")]),s._v(" "),t("h3",{attrs:{id:"_2-图解方法执行流程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-图解方法执行流程"}},[s._v("#")]),s._v(" 2）图解方法执行流程")]),s._v(" "),t("p",[s._v("Todo zsj")]),s._v(" "),t("p",[s._v("代码")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Demo3_1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" b "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Short")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("MAX_VALUE "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("常量池载入运行时常量池")]),s._v(" "),t("p",[s._v("常量池也属于方法区，只不过这里单独提出来了")]),s._v(" "),t("p",[t("img",{attrs:{src:n(494),alt:"",loading:"lazy"}})]),s._v(" "),t("p",[s._v("方法字节码载入方法区")]),s._v(" "),t("p",[s._v("(stack=2，locals=4) 对应操作数栈有 2 个空间(每个空间 4 个字节)，局部变量表中有 4 个槽位。")]),s._v(" "),t("p",[t("img",{attrs:{src:n(495),alt:"",loading:"lazy"}})]),s._v(" "),t("p",[s._v("执行引擎开始执行字节码")]),s._v(" "),t("p",[s._v("Bipush 10")]),s._v(" "),t("ul",[t("li",[s._v("将一个 byte 压入操作数栈(其长度会补齐 4 个字节)，类似的指令还有\n"),t("ul",[t("li",[s._v("sipush 将一个 short 压入操作数栈(其长度会补齐 4 个字节)")]),s._v(" "),t("li",[s._v("ldc 将一个 int 压入操作数栈")]),s._v(" "),t("li",[s._v("ldc2_w 将一个 long 压入操作数栈（"),t("strong",[s._v("分两次压入")]),s._v("，因为 long 是 8 个字节）")]),s._v(" "),t("li",[s._v("这里小的数字都是和字节码指令存在一起，"),t("strong",[s._v("超过 short 范围的数字存入了常量池")])])])])]),s._v(" "),t("p",[s._v("Istore 1")]),s._v(" "),t("p",[s._v("将操作数栈栈顶元素弹出，放入局部变量表的 slot 1 中")]),s._v(" "),t("p",[s._v("对应代码中的 a = 10")]),s._v(" "),t("p",[s._v("3）通过字节码指令分析问题")]),s._v(" "),t("p",[s._v("代码")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://blog.csdn.net/weixin_50280576/article/details/113784268",target:"_blank",rel:"noopener noreferrer"}},[s._v("csdn"),t("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);